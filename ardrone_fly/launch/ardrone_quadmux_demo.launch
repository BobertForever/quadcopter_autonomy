<launch>

  <!--
  	4 mode demo:
	 - mux1: wiimote control
	 - mux2: leap motion control
	 - mux3: kalman filter ball following (orange ball)
	 - mux4: hoop trick - kalman follow hoop with purple/red left/right markers; go through hoop and flip upon successful seek
  -->
  
  <!-- ardrone driver -->
  <node pkg="ardrone_autonomy" type="ardrone_driver" name="ardrone" />

  <!-- human controls -->
  <node respawn="true" pkg="wiimote"  type="wiimote_node.py" name="arWii" />
  <node respawn="true" pkg="rosleap" type="rosleap" name="rosleap" />

  <!-- kalman ball follow: autonomous controls & their dependencies -->
  <node pkg="cmvision" type="cmvision" name="cmvision">
    <remap from="image" to="ardrone/front/image_raw" />
    <param name="color_file" value="/home/bwi/catkin_ws/src/quadcopter_autonomy/ardrone_fly/colors.txt" />
    <param name="mean_shift_on" value="false" />  
    <param name="spatial_radius_pix" value="0" />
    <param name="color_radius_pix" value="0" />
	<param name="debug_on" value="false" />
  </node>
  <node respawn="true" pkg="ardrone_fly" type="kalmanBallTrack" name="kalmanBallTrack" />

  <!-- kalman hoop trick: autonomous controls & their dependencies -->
  <node pkg="cmvision" type="cmvision" name="cmvision_hoop">
    <remap from="image" to="ardrone/front/image_raw" />
    <param name="color_file" value="/home/bwi/catkin_ws/src/quadcopter_autonomy/ardrone_fly/colors2.txt" />
    <param name="mean_shift_on" value="false" />  
    <param name="spatial_radius_pix" value="0" />
    <param name="color_radius_pix" value="0" />
	<param name="debug_on" value="true" />
    <remap from="blobs" to="kalmanHoopTrack/blobs" />
  </node>
  <node respawn="true" pkg="ardrone_fly" type="kalmanHoopTrack" name="kalmanHoopTrack">
    <remap from="blobs" to="kalmanHoopTrack/blobs" />
  </node>

  <!-- flight control -->  
  <node pkg="ardrone_fly" type="wiimoteFly" name="wiiFly">
	  <remap from="cmd_vel" to="wiimoteFly/cmd_vel" />
  </node>
  <node pkg="ardrone_fly" type="leapFly" name="leapFly">
	  <remap from="cmd_vel" to="leapFly/cmd_vel" />
  </node>
  <node pkg="ardrone_fly" type="ballPosFly" name="ballPosFly">
    <remap from="cmd_vel" to="ballPosFly/cmd_vel" />
  </node>
  <node output="screen" pkg="ardrone_fly" type="hoopTrickFly" name="hoopTrickFly">
    <remap from="cmd_vel" to="hoopTrickFly/cmd_vel" />
  </node>

  <!-- multiplexing -->
  <node pkg="topic_tools" type="mux" name="mux" args="cmd_vel wiimoteFly/cmd_vel leapFly/cmd_vel ballPosFly/cmd_vel hoopTrickFly/cmd_vel">
  	<remap from="mux" to="wii_leap_mux" />
  </node>
  <node pkg="ardrone_fly" type="wiiMuxSwitch" name="wiiMuxSwitch">
	  <remap from="mux" to="wii_leap_mux" />
  </node>

</launch>
